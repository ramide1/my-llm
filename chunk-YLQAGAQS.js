import{a as c,b as n,qa as o}from"./chunk-WAVSKRIQ.js";import{h as a}from"./chunk-LUL4G5ZA.js";var p=(()=>{let e=class e{constructor(t){this.storageService=t,this.chats=[],this.CHATS_STORAGE_KEY="chats"}getChats(){return a(this,null,function*(){try{yield this.storageService.init();let t=yield this.storageService.get(this.CHATS_STORAGE_KEY);return t!==null&&t.length!==0&&(this.chats=t,this.chats.sort((r,s)=>new Date(s.created).getTime()-new Date(r.created).getTime())),!0}catch{return!1}})}updateChats(){return a(this,null,function*(){try{return yield this.storageService.set(this.CHATS_STORAGE_KEY,this.chats),!0}catch{return!1}})}addChat(t){return a(this,null,function*(){try{if(this.chats.find(h=>h.id===t.id))throw new Error("This chat already exists");if(this.chats.push(t),!(yield this.updateChats()))throw new Error("Error updating chats");return!0}catch{return!1}})}getChat(t){try{let r=this.chats.find(s=>s.id===t);if(!r)throw new Error("This chat not exists");return r}catch{return null}}addMessage(t,r){return a(this,null,function*(){try{let s=this.chats.find(d=>d.id===t);if(!s)throw new Error("This chat not exists");if(s.messages.push(r),!(yield this.updateChats()))throw new Error("Error updating chats");return!0}catch{return!1}})}};e.\u0275fac=function(r){return new(r||e)(n(o))},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();export{p as a};
